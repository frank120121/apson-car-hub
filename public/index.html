<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>NexCar | Tu Pr√≥ximo Auto</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://firestore.googleapis.com">
    <link rel="preconnect" href="https://www.gstatic.com">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="module" src="./js/logic.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style> 
        body { font-family: 'Inter', sans-serif; background-color: #F0F2F5; } 
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none;  scrollbar-width: none; }
        
        /* AUTHENTIC LIQUID GLASS STYLING */
        .liquid-glass {
            background: rgba(255, 255, 255, 0.03); /* Extremely transparent */
            backdrop-filter: blur(40px) saturate(200%) brightness(1.1); /* Heavy blur + color boost */
            -webkit-backdrop-filter: blur(40px) saturate(200%) brightness(1.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-top: 1px solid rgba(255, 255, 255, 0.5); /* Specular top highlight */
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.05), /* Soft ambient shadow */
                inset 0 0 0 1px rgba(255, 255, 255, 0.1); /* Inner rim light */
        }

        .liquid-glass-frost {
            background: rgba(255, 255, 255, 0.4); /* Milkier glass for visibility */
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.4);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .liquid-button {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.4);
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }

        .animate-fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes shimmer { 100% { transform: translateX(100%); } }
        .group-hover\:animate-shimmer:hover { animation: shimmer 1.5s infinite; }
        @keyframes progress { 0% { width: 0%; } 100% { width: 100%; } }
        .animate-progress { animation: progress 2s ease-out forwards; }
        .ease-spring { transition-timing-function: cubic-bezier(0.175, 0.885, 0.32, 1.1); }
        .ease-out-expo { transition-timing-function: cubic-bezier(0.16, 1, 0.3, 1); }
    </style>
</head>

<body class="pb-24 select-none antialiased text-gray-800" x-data="app()">
    <div x-show="introOpen" 
        class="fixed inset-0 z-[100] bg-[#F5F7FA] flex flex-col items-center justify-center p-6 transition-all duration-700 ease-in-out overflow-hidden"
        x-transition:leave="transform -translate-y-full opacity-0">

        <div class="absolute inset-0 overflow-hidden pointer-events-none">
            <div class="absolute top-[10%] left-[10%] w-[300px] h-[300px] bg-blue-500/30 rounded-full blur-[80px] animate-pulse"></div>
            <div class="absolute bottom-[20%] right-[10%] w-[400px] h-[400px] bg-purple-500/30 rounded-full blur-[100px] animate-pulse" style="animation-delay: 1s"></div>
            <div class="absolute top-[40%] left-[50%] w-[200px] h-[200px] bg-teal-400/20 rounded-full blur-[60px]" style="animation-delay: 2s"></div>
        </div>

        <div class="relative z-10 w-full max-w-xs flex flex-col items-center">
            
            <div class="mb-12 relative" x-data="{ scale: false }" x-init="setTimeout(() => scale = true, 200)">
                <h1 class="text-7xl font-black tracking-tighter text-gray-900 transform -skew-x-12 transition-transform duration-700 drop-shadow-sm mix-blend-overlay"
                    :class="scale ? 'scale-110' : 'scale-100'">
                    NEX<span class="text-blue-600">CAR</span>
                </h1>
                <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-48 h-32 liquid-glass rounded-full blur-xl -z-10 opacity-50"></div>
            </div>

            <div class="h-8 mb-12 text-center" x-data="{ 
                    text: '', 
                    fullText: 'Encuentra tu pr√≥ximo auto.', 
                    idx: 0,
                    type() {
                        if (this.idx < this.fullText.length) {
                            this.text += this.fullText.charAt(this.idx);
                            this.idx++;
                            setTimeout(() => this.type(), 50);
                        }
                    }
                }" x-init="setTimeout(() => type(), 500)">
                <p class="text-lg font-medium text-gray-600 tracking-tight" x-text="text"></p>
            </div>

            <div class="grid grid-cols-1 gap-4 w-full">
                <button @click="enterApp('comprar')" 
                        class="group relative w-full py-5 liquid-glass text-blue-600 font-bold rounded-2xl active:scale-95 transition-all overflow-hidden tracking-wide text-lg shadow-lg">
                    <div class="absolute inset-0 w-full h-full bg-gradient-to-r from-transparent via-white/40 to-transparent -translate-x-full group-hover:animate-shimmer"></div>
                    <span class="relative z-10 drop-shadow-sm">Comprar</span>
                </button>
                
                <div class="grid grid-cols-2 gap-3">
                    <button @click="enterApp('vender')" class="py-4 liquid-glass text-gray-700 font-bold rounded-2xl active:scale-95 transition-all hover:bg-white/10">
                        Vender
                    </button>
                    <button @click="enterApp('cambiar')" class="py-4 liquid-glass text-gray-700 font-bold rounded-2xl active:scale-95 transition-all hover:bg-white/10">
                        Cambiar
                    </button>
                </div>
            </div>

            <div class="mt-12 flex flex-col items-center">
                <p class="text-[10px] text-gray-400 mb-2 uppercase tracking-widest font-semibold">Cargando inventario...</p>
                <div class="w-32 h-1.5 bg-gray-200/50 rounded-full overflow-hidden backdrop-blur-sm">
                    <div class="h-full bg-blue-600 rounded-full animate-progress shadow-[0_0_10px_rgba(37,99,235,0.5)]"></div>
                </div>
            </div>
        </div>
    </div>

    <header class="fixed top-4 left-4 right-4 z-40 transition-transform duration-700 ease-[cubic-bezier(0.32,0.72,0,1)]"
            :class="visible ? 'translate-y-0' : '-translate-y-[200%]'"
            x-data="{ 
                visible: true, 
                lastScroll: 0,
                placeholder: '', 
                textIndex: 0, 
                charIndex: 0, 
                isDeleting: false,
                examples: ['Busca por marca...', 'Busca por modelo...', 'Busca por a√±o...', 'Busca por versi√≥n...'],
                
                initScroll() {
                    window.addEventListener('scroll', () => {
                        const current = window.pageYOffset;
                        if (current <= 10) { this.visible = true; this.lastScroll = current; return; }
                        const diff = current - this.lastScroll;
                        if (Math.abs(diff) > 10) { this.visible = diff < 0; }
                        this.lastScroll = current;
                    });
                },
                type() {
                    const current = this.examples[this.textIndex];
                    if (this.isDeleting) {
                        this.placeholder = current.substring(0, this.charIndex - 1);
                        this.charIndex--;
                    } else {
                        this.placeholder = current.substring(0, this.charIndex + 1);
                        this.charIndex++;
                    }
                    if (!this.isDeleting && this.charIndex === current.length) {
                        this.isDeleting = true;
                        setTimeout(() => this.type(), 1500); 
                    } else if (this.isDeleting && this.charIndex === 0) {
                        this.isDeleting = false;
                        this.textIndex = (this.textIndex + 1) % this.examples.length;
                        setTimeout(() => this.type(), 500);
                    } else {
                        setTimeout(() => this.type(), this.isDeleting ? 50 : 100);
                    }
                }
            }" 
            x-init="initScroll(); type()">

        <div class="p-3 rounded-3xl liquid-glass">
            
            <div class="flex justify-between items-center mb-3 px-2">
                <h1 class="text-2xl font-black tracking-tighter text-gray-900 transform -skew-x-12 drop-shadow-sm mix-blend-darken">
                    NEX<span class="text-blue-600">CAR</span>
                </h1>
                <button @click="startSelling()" class="text-xs font-bold text-blue-700 bg-white/40 px-3 py-1.5 rounded-full border border-white/60 hover:bg-white/60 transition-colors shadow-sm backdrop-blur-md">
                    + Vender
                </button>
            </div>

            <div class="flex items-center gap-2">
                <div class="flex-1 relative group" @click="openSearch()">
                    <div class="flex items-center bg-white/20 rounded-2xl px-3 py-2.5 h-10 border border-white/20 shadow-inner group-focus-within:bg-white/40 transition-all backdrop-blur-md">
                        <span class="text-gray-600 mr-2 opacity-70">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 1024 1024"><path d="M114.239 474.82c0-200.096 162.21-362.307 362.307-362.307s362.307 162.21 362.307 362.307c0 200.095-162.212 362.307-362.307 362.307s-362.307-162.212-362.307-362.307zM476.546 32.001c-244.562 0-442.819 198.257-442.819 442.819 0 244.56 198.257 442.819 442.819 442.819 106.905 0 204.964-37.883 281.483-100.958l163.526 163.526c15.721 15.721 41.205 15.721 56.927 0s15.721-41.211 0-56.933l-163.215-163.215c64.958-77.051 104.098-176.575 104.098-285.24 0-244.562-198.259-442.819-442.819-442.819z"></path></svg>
                        </span>
                        <input type="text" class="w-full bg-transparent text-sm text-gray-800 placeholder-gray-600/70 font-bold outline-none" :placeholder="placeholder" readonly>
                    </div>
                </div>
                
                <button @click="openFilter()" class="w-10 h-10 flex items-center justify-center liquid-button rounded-xl active:scale-90 transition-transform text-blue-600">
                    <svg class="w-5 h-5 drop-shadow-sm" fill="currentColor" viewBox="0 0 1024 1024"><path d="M345.143 245.029c-55.291 0-100.114 44.823-100.114 100.114s44.823 100.114 100.114 100.114c55.291 0 100.114-44.823 100.114-100.114s-44.823-100.114-100.114-100.114zM345.143 178.286c80.725 0 148.056 57.326 163.52 133.486h437.166c18.429 0 33.371 14.943 33.371 33.371s-14.943 33.371-33.371 33.371h-437.166c-15.464 76.161-82.795 133.486-163.52 133.486s-148.058-57.324-163.52-133.486h-103.451c-18.429 0-33.371-14.943-33.371-33.371s14.943-33.371 33.371-33.371h103.451c15.462-76.16 82.794-133.486 163.52-133.486zM678.857 578.743c-55.29 0-100.114 44.824-100.114 100.114s44.824 100.114 100.114 100.114c55.29 0 100.114-44.824 100.114-100.114s-44.824-100.114-100.114-100.114zM678.857 512c80.725 0 148.056 57.324 163.52 133.486h103.451c18.429 0 33.371 14.943 33.371 33.371s-14.943 33.371-33.371 33.371h-103.451c-15.464 76.161-82.795 133.486-163.52 133.486s-148.056-57.324-163.52-133.486h-437.166c-18.429 0-33.371-14.943-33.371-33.371s14.943-33.371 33.371-33.371h437.166c15.464-76.161 82.795-133.486 163.52-133.486z"></path></svg>
                </button>
                <button @click="openSort()" class="w-10 h-10 flex items-center justify-center liquid-button rounded-xl active:scale-90 transition-transform">
                    <svg class="w-5 h-5 drop-shadow-sm" fill="none" stroke="#1351EC" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"></path></svg>
                </button>
            </div>
        </div>
    </header>

    <div class="fixed inset-0 z-0 overflow-hidden pointer-events-none">
        <div class="absolute top-0 right-0 w-[500px] h-[500px] bg-blue-200/20 rounded-full blur-[100px] -mr-32 -mt-32"></div>
        <div class="absolute bottom-0 left-0 w-[500px] h-[500px] bg-purple-200/20 rounded-full blur-[100px] -ml-32 -mb-32"></div>
    </div>

    <main class="relative z-10 px-4 pt-44 pb-28">
        <div x-show="currentView !== 'profile'">
            <div class="mb-6">
                <div x-data 
                    x-init="$watch('introOpen', value => { 
                        if (!value) {
                            setTimeout(() => { 
                                $el.scrollBy({left: 100, behavior: 'smooth'}); 
                                setTimeout(() => { $el.scrollBy({left: -100, behavior: 'smooth'}); }, 600); 
                            }, 800);
                        }
                    })"
                    class="flex overflow-x-auto snap-x snap-mandatory gap-3 no-scrollbar pb-2 px-1">

                    <div class="snap-center shrink-0 w-[92%] h-44 bg-gradient-to-br from-blue-600 to-indigo-800 rounded-3xl p-5 text-white flex flex-col justify-between relative overflow-hidden shadow-lg border border-white/10">
                        <div class="absolute inset-0 bg-white/5 backdrop-blur-[2px]"></div>
                        <div class="relative z-10"><span class="bg-white/20 text-xs font-bold px-2 py-0.5 rounded-md border border-white/20 backdrop-blur-md">Financiamiento</span><h2 class="text-xl font-extrabold mt-2 leading-tight">Ll√©vatelo a Cr√©dito</h2><p class="text-blue-100 text-xs mt-1">Pagos chiquitos desde $3,000/mes</p></div>
                        <button class="relative z-10 bg-white/90 backdrop-blur text-blue-700 text-xs font-bold py-2 px-4 rounded-xl w-max shadow-sm active:scale-95 transition-transform border border-white/50">Ver opciones</button>
                        <div class="absolute -bottom-8 -right-8 w-32 h-32 bg-blue-400/30 rounded-full blur-2xl"></div><div class="absolute top-4 right-4 text-5xl opacity-20 rotate-12">üè¶</div>
                    </div>

                    <div @click="startSelling()" class="cursor-pointer snap-center shrink-0 w-[92%] h-44 bg-gradient-to-br from-purple-600 to-pink-600 rounded-3xl p-5 text-white flex flex-col justify-between relative overflow-hidden shadow-lg hover:shadow-xl transition-shadow border border-white/10">
                         <div class="absolute inset-0 bg-white/5 backdrop-blur-[2px]"></div>
                        <div class="relative z-10">
                            <span class="bg-white/20 text-xs font-bold px-2 py-0.5 rounded-md border border-white/20 backdrop-blur-md">Vender</span>
                            <h2 class="text-xl font-extrabold mt-2 leading-tight">¬øCambias de auto?</h2>
                            <p class="text-purple-100 text-xs mt-1">Recibe una oferta en minutos</p>
                        </div>
                        <div class="relative z-10 bg-white/90 backdrop-blur text-purple-700 text-xs font-bold py-2 px-4 rounded-xl w-max shadow-sm active:scale-95 transition-transform border border-white/50">Cotizar ahora</div>
                        <div class="absolute -top-8 -left-8 w-32 h-32 bg-purple-400/30 rounded-full blur-2xl"></div>
                        <div class="absolute bottom-4 right-4 text-5xl opacity-20 -rotate-12">ü§ù</div>
                    </div>

                    <div class="snap-center shrink-0 w-[92%] h-44 bg-gradient-to-br from-teal-600 to-emerald-700 rounded-3xl p-5 text-white flex flex-col justify-between relative overflow-hidden shadow-lg border border-white/10">
                        <div class="absolute inset-0 bg-white/5 backdrop-blur-[2px]"></div>
                        <div class="relative z-10"><span class="bg-white/20 text-xs font-bold px-2 py-0.5 rounded-md border border-white/20 backdrop-blur-md">Garant√≠a</span><h2 class="text-xl font-extrabold mt-2 leading-tight">Compra Segura</h2><p class="text-teal-100 text-xs mt-1">3 meses de garant√≠a mec√°nica</p></div>
                        <button class="relative z-10 bg-white/90 backdrop-blur text-teal-800 text-xs font-bold py-2 px-4 rounded-xl w-max shadow-sm active:scale-95 transition-transform border border-white/50">Saber m√°s</button>
                        <div class="absolute bottom-[-10px] right-[-10px] text-6xl opacity-20">üõ°Ô∏è</div>
                    </div>
                </div>
            </div>

            <h3 class="font-bold text-gray-800 mb-3 text-sm uppercase tracking-wide pl-2 opacity-80" x-text="currentView === 'favorites' ? 'Tus Favoritos' : 'Reci√©n Llegados'"></h3>
            
            <div x-show="loading" class="text-center py-10 text-gray-400">
                <div class="animate-spin mb-2 text-2xl">‚è≥</div>
                <p>Cargando inventario...</p>
            </div>

            <div x-show="error" class="bg-red-50 text-red-600 p-4 rounded-xl text-center mb-4 border border-red-100">
                <p class="font-bold">‚ö†Ô∏è Error</p>
                <p x-text="error" class="text-sm"></p>
            </div>
            
            <div class="grid gap-5">
                <template x-for="(car, index) in filteredCars" :key="car.id">
                    <div class="contents">
                        <div class="bg-white rounded-3xl shadow-[0_10px_30px_-10px_rgba(0,0,0,0.1)] overflow-hidden active:scale-95 transition-transform duration-100 ease-out-expo border border-white/50" @click="openCar(car)">
                            <div class="relative h-60 bg-gray-200">
                                <img :src="car.image" src="https://placehold.co/600x400?text=Cargando..." class="w-full h-full object-cover" :loading="index < 2 ? 'eager' : 'lazy'" :fetchpriority="index < 2 ? 'high' : 'auto'" alt="Foto del auto">
                                <div class="absolute top-0 right-0 left-0 flex justify-between p-3 z-10">
                                    <div x-show="car.promoted" class="liquid-glass text-yellow-900 text-[10px] font-bold px-2 py-1 rounded-lg border-yellow-200/30">DESTACADO</div>
                                    <div x-show="!car.promoted"></div>
                                </div>
                                <div class="absolute bottom-3 left-3 flex gap-1 z-20">
                                    <span x-show="car.verified" class="bg-blue-600/90 backdrop-blur-md text-white text-[10px] font-bold px-2 py-1 rounded-lg shadow-sm flex items-center gap-1 border border-white/20">
                                        <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                                        Verificado
                                    </span>
                                </div>
                                <button @click.stop="toggleFavorite(car.id)" class="absolute top-3 right-3 p-2 rounded-full shadow-lg transition-transform active:scale-90 z-20 border border-white/20" :class="favorites.includes(car.id) ? 'bg-red-500 text-white' : 'liquid-glass text-white'">
                                    <svg x-show="favorites.includes(car.id)" class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                                    <svg x-show="!favorites.includes(car.id)" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>
                                </button>
                                <div class="absolute bottom-3 right-3 liquid-glass text-white text-xs px-3 py-1 rounded-lg font-mono border border-white/20 shadow-lg"><span x-text="car.year"></span></div>
                            </div>
                            <div class="p-5 relative">
                                <div class="absolute top-0 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-gray-200 to-transparent"></div>
                                
                                <div class="flex justify-between items-start mb-1">
                                    <h3 class="text-lg font-extrabold text-gray-900 leading-tight line-clamp-1" x-text="car.model"></h3>
                                    <span class="text-blue-600 font-black text-lg whitespace-nowrap" x-text="formatMoney(car.price)"></span>
                                </div>
                                <div class="flex justify-between items-center mb-4">
                                    <p class="text-sm text-gray-500 font-medium" x-text="car.year + ' ‚Ä¢ ' + car.km + ' km'"></p>
                                    <span class="text-[10px] text-gray-400 font-semibold flex items-center gap-1">
                                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                        <span x-text="timeAgo(car.date)"></span>
                                    </span>
                                </div>
                                <div class="flex flex-wrap gap-2">
                                    <span class="px-2 py-1 bg-gray-100 border border-gray-200 text-gray-600 text-[11px] font-bold rounded-lg uppercase tracking-wider" x-text="car.legal"></span>
                                    <span x-show="car.trans === 'Auto'" class="px-2 py-1 bg-gray-100 border border-gray-200 text-gray-600 text-[11px] font-bold rounded-lg uppercase tracking-wider">Aut</span>
                                    <span x-show="car.trans === 'Std'" class="px-2 py-1 bg-gray-100 border border-gray-200 text-gray-600 text-[11px] font-bold rounded-lg uppercase tracking-wider">Std</span>
                                    <span x-show="car.is4x4" class="px-2 py-1 bg-gray-900 text-white text-[11px] font-bold rounded-lg flex items-center gap-1">
                                        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 11l7-7 7 7M5 19l7-7 7 7"></path></svg> 4x4
                                    </span>
                                </div>
                            </div>
                        </div>

                        <template x-if="(index + 1) % 5 === 0">
                            <div class="contents" x-data="{ promo: promos[((index + 1) / 5 - 1) % promos.length] }">
                                <a :href="promo.link" 
                                class="block rounded-3xl shadow-lg overflow-hidden relative text-white p-6 active:scale-95 transition-transform h-auto min-h-[14rem] flex flex-col justify-center items-start border border-white/10"
                                :class="'bg-gradient-to-r ' + promo.color">
                                    <div class="absolute inset-0 bg-white/5 backdrop-blur-[1px]"></div>
                                    <div class="absolute top-0 right-0 w-32 h-32 bg-white/20 rounded-full blur-2xl -mr-10 -mt-10"></div>
                                    <div class="absolute bottom-0 right-0 w-24 h-24 bg-white/20 rounded-full blur-xl mr-4 mb-4"></div>
                                    <div class="relative z-10 w-2/3">
                                        <span class="bg-white/20 text-xs font-bold px-2 py-1 rounded-md mb-3 inline-block border border-white/20 backdrop-blur-md" x-text="promo.tag"></span>
                                        <h3 class="text-2xl font-extrabold leading-tight mb-2" x-text="promo.title"></h3>
                                        <p class="text-white/90 text-sm mb-6" x-text="promo.desc"></p>
                                        <button class="bg-white/90 backdrop-blur-md text-gray-900 font-bold py-3 px-6 rounded-xl shadow-lg text-sm flex items-center gap-2 border border-white/50">
                                            <span x-text="promo.btn"></span>
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>
                                        </button>
                                    </div>
                                    <div class="absolute right-[-10px] bottom-[-10px] text-8xl opacity-20 rotate-[-10deg]" x-text="promo.icon"></div>
                                </a>
                            </div>
                        </template>
                    </div>
                </template>
                
                <div x-show="!loading && filteredCars.length === 0" class="text-center py-10 text-gray-400">
                    <div x-show="currentView === 'home'">
                        <p>No se encontraron resultados.</p>
                        <button @click="clearFilters()" class="text-blue-600 font-bold mt-2">Limpiar Filtros</button>
                    </div>
                    <div x-show="currentView === 'favorites'">
                        <p class="text-4xl mb-2">üíî</p>
                        <p>A√∫n no tienes favoritos.</p>
                        <button @click="currentView = 'home'" class="text-blue-600 font-bold mt-2">Explorar Autos</button>
                    </div>
                </div>
            </div>
        </div>

        <div x-show="currentView === 'profile'" class="min-h-[70vh] flex flex-col items-center justify-center p-6 animate-fade-in relative z-10">
            
            <template x-if="!isLoggedIn">
                <div class="w-full max-w-sm text-center bg-white/50 backdrop-blur-xl rounded-3xl p-6 shadow-xl border border-white/40">
                    
                    <div class="flex justify-center mb-6">
                        <div class="bg-gray-200/50 p-1 rounded-full inline-flex relative cursor-pointer backdrop-blur" 
                             @click="signupIntent = (signupIntent === 'buy' ? 'sell' : 'buy')">
                            
                            <div class="absolute top-1 bottom-1 w-[calc(50%-4px)] bg-white rounded-full shadow-sm transition-all duration-300 ease-out"
                                 :class="signupIntent === 'buy' ? 'left-1' : 'left-[calc(50%)]'"></div>

                            <div class="relative z-10 px-6 py-1.5 text-xs font-bold uppercase tracking-wide transition-colors duration-300"
                                 :class="signupIntent === 'buy' ? 'text-blue-600' : 'text-gray-400'">
                                Comprar
                            </div>
                            <div class="relative z-10 px-6 py-1.5 text-xs font-bold uppercase tracking-wide transition-colors duration-300"
                                 :class="signupIntent === 'sell' ? 'text-purple-600' : 'text-gray-400'">
                                Vender
                            </div>
                        </div>
                    </div>

                    <h2 class="text-2xl font-extrabold text-gray-900 mb-2">Bienvenido a NexCar</h2>
                    <p class="text-gray-500 mb-6" x-text="signupIntent === 'buy' ? 'Encuentra tu pr√≥ximo auto hoy.' : 'Publica tu auto y recibe ofertas.'"></p>

                    <div class="space-y-3 mb-6 text-left">
                        <div x-show="authError" class="bg-red-50 text-red-500 text-xs p-3 rounded-lg mb-2 border border-red-100" x-text="authError"></div>

                        <div x-show="authMode === 'register'" x-transition>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-1 ml-1">Tu Nombre</label>
                            <input type="text" x-model="displayName" placeholder="Juan P√©rez" class="w-full p-4 bg-white/70 rounded-xl border-transparent focus:bg-white focus:ring-2 focus:ring-blue-500 outline-none transition-all shadow-sm">
                        </div>

                        <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-1 ml-1">Correo</label>
                            <input type="email" x-model="email" placeholder="hola@ejemplo.com" class="w-full p-4 bg-white/70 rounded-xl border-transparent focus:bg-white focus:ring-2 focus:ring-blue-500 outline-none transition-all shadow-sm">
                        </div>

                        <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-1 ml-1">Contrase√±a</label>
                            <input type="password" x-model="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" class="w-full p-4 bg-white/70 rounded-xl border-transparent focus:bg-white focus:ring-2 focus:ring-blue-500 outline-none transition-all shadow-sm">
                            
                            <p x-show="authMode === 'register'" class="text-[10px] mt-1 ml-1 transition-colors" 
                               :class="password.length >= 8 ? 'text-green-500 font-bold' : 'text-gray-400'">
                                M√≠nimo 8 caracteres <span x-show="password.length >= 8">‚úì</span>
                            </p>
                        </div>
                    </div>

                    <button @click="submitAuth()" 
                            :disabled="!canSubmit || loading"
                            class="w-full py-4 font-bold rounded-xl transition-all mb-4"
                            :class="canSubmit && !loading ? 'bg-blue-600 text-white shadow-lg shadow-blue-200 active:scale-95 cursor-pointer' : 'bg-gray-200 text-gray-400 cursor-not-allowed'">
                        <span x-show="!loading">
                            <span x-text="authMode === 'login' ? 'Iniciar Sesi√≥n' : 'Crear Cuenta'"></span>
                        </span>
                        <span x-show="loading" class="flex items-center justify-center gap-2">
                            <svg class="w-5 h-5 animate-spin" fill="none" viewBox="0 0 24 24">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path>
                            </svg>
                            <span>Procesando...</span>
                        </span>
                    </button>

                    <button @click="loginGoogle()" class="w-full py-4 bg-white border border-gray-100 shadow-sm text-gray-700 font-bold rounded-xl active:bg-gray-50 transition-all flex items-center justify-center gap-2">
                        <img src="https://www.svgrepo.com/show/475656/google-color.svg" class="w-5 h-5"> 
                        Continuar con Google
                    </button>

                    <p class="mt-6 text-sm text-gray-400">
                        <span x-text="authMode === 'login' ? '¬øNo tienes cuenta?' : '¬øYa tienes cuenta?'"></span>
                        <button @click="toggleAuthMode()" class="text-blue-600 font-bold ml-1">
                            <span x-text="authMode === 'login' ? 'Reg√≠strate' : 'Inicia Sesi√≥n'"></span>
                        </button>
                    </p>
                </div>
            </template>

            <template x-if="isLoggedIn">
                <div class="w-full max-w-sm text-center bg-white/60 backdrop-blur-xl rounded-3xl p-6 shadow-xl border border-white/40">
                    <div class="mb-8">
                        <div class="w-24 h-24 bg-gradient-to-tr from-blue-500 to-purple-600 rounded-full mx-auto mb-4 p-1 shadow-xl">
                            <div class="w-full h-full bg-white rounded-full flex items-center justify-center overflow-hidden">
                                <template x-if="user?.photo">
                                    <img :src="user.photo" class="w-full h-full object-cover">
                                </template>
                                <template x-if="!user?.photo">
                                    <span class="text-4xl">üë§</span>
                                </template>
                            </div>
                        </div>
                        <h2 class="text-2xl font-extrabold text-gray-900" x-text="user?.name || 'Usuario'"></h2>
                        <p class="text-gray-400 text-sm" x-text="user?.email"></p>
                        
                        <div class="mt-3">
                            <span class="inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-bold"
                                  :class="{
                                      'bg-green-100 text-green-700': userProfile?.sellerStatus === 'approved',
                                      'bg-yellow-100 text-yellow-700': userProfile?.sellerStatus === 'pending',
                                      'bg-red-100 text-red-700': userProfile?.sellerStatus === 'rejected',
                                      'bg-gray-100 text-gray-600': !userProfile?.sellerStatus || userProfile?.sellerStatus === 'none'
                                  }">
                                <template x-if="userProfile?.sellerStatus === 'approved'">
                                    <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                                </template>
                                <span x-text="sellerStatusText"></span>
                            </span>
                        </div>
                    </div>
                    
                    <div class="grid gap-3 mb-8">
                        <template x-if="isApprovedSeller">
                            <a href="sell.html" class="flex items-center gap-4 p-4 bg-white border border-gray-100 focus:ring-2 rounded-2xl shadow-sm active:scale-95 transition-transform">
                                <div class="w-10 h-10 bg-green-100 text-green-600 rounded-full flex items-center justify-center">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                                </div>
                                <div class="text-left flex-1">
                                    <p class="font-bold text-gray-800">Vender un Auto</p>
                                    <p class="text-xs text-gray-400">Publica tu unidad en minutos</p>
                                </div>
                                <svg class="w-5 h-5 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                            </a>
                        </template>
                        
                        <template x-if="isPendingSeller">
                            <div class="flex items-center gap-4 p-4 bg-yellow-50/50 backdrop-blur border border-yellow-200 rounded-2xl">
                                <div class="w-10 h-10 bg-yellow-100 text-yellow-600 rounded-full flex items-center justify-center">
                                    <svg class="w-5 h-5 animate-spin" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path></svg>
                                </div>
                                <div class="text-left flex-1">
                                    <p class="font-bold text-yellow-800">Solicitud en Revisi√≥n</p>
                                    <p class="text-xs text-yellow-600">Te notificaremos cuando sea aprobada</p>
                                </div>
                            </div>
                        </template>
                        
                        <template x-if="!isApprovedSeller && !isPendingSeller">
                            <button @click="sellerModalOpen = true" class="flex items-center gap-4 p-4 bg-white border border-gray-100 focus:ring-2 rounded-2xl shadow-sm active:scale-95 transition-transform">
                                <div class="w-10 h-10 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                                </div>
                                <div class="text-left flex-1">
                                    <p class="font-bold text-gray-800">Quiero Vender</p>
                                    <p class="text-xs text-gray-400">Solicita acceso de vendedor</p>
                                </div>
                                <svg class="w-5 h-5 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                            </button>
                        </template>

                        <button class="flex items-center gap-4 p-4 bg-white border border-gray-100 focus:ring-2 rounded-2xl shadow-sm active:scale-95 transition-transform">
                            <div class="w-10 h-10 bg-purple-100 text-purple-600 rounded-full flex items-center justify-center">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg>
                            </div>
                            <div class="text-left flex-1">
                                <p class="font-bold text-gray-800">Mis Autos</p>
                                <p class="text-xs text-gray-400">Gestiona tus publicaciones</p>
                            </div>
                        </button>
                    </div>
                    <button @click="logout()" class="text-red-500 font-bold text-sm py-2 px-4 rounded-lg hover:bg-red-50 transition-colors">Cerrar Sesi√≥n</button>
                </div>
            </template>
        </div>
    </main>

    <nav class="fixed bottom-6 left-0 right-0 z-50 flex justify-center transition-all duration-500 ease-[cubic-bezier(0.32,0.72,0,1)] origin-bottom"
         x-data="{ 
             compact: false, 
             lastScroll: 0,
             initNavScroll() {
                 window.addEventListener('scroll', () => {
                     const current = window.pageYOffset;
                     if (current <= 10) { this.compact = false; this.lastScroll = current; return; }
                     const diff = current - this.lastScroll;
                     if (Math.abs(diff) > 10) { this.compact = diff > 0; }
                     this.lastScroll = current;
                 });
             }
         }"
         x-init="initNavScroll()"
         :class="compact ? 'translate-y-2' : 'translate-y-0'">

        <div class="liquid-glass flex justify-between items-center transition-all duration-500 max-w-sm mx-4"
             :class="compact ? 'w-[65%] h-14 rounded-full px-5' : 'w-[85%] h-16 rounded-3xl px-6'">

            <button @click="currentView = 'home'; window.scrollTo({top:0})" 
                    class="flex items-center justify-center w-10 h-10 rounded-full transition-all duration-300 relative" 
                    :class="currentView === 'home' && !searchOpen ? 'text-blue-600 scale-110' : 'text-gray-500 hover:text-gray-800'">
                <div x-show="currentView === 'home' && !searchOpen" class="absolute inset-0 bg-white/40 blur-lg rounded-full"></div>
                <svg class="w-6 h-6 relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg>
            </button>

            <button @click="openSearch()" 
                    class="flex items-center justify-center w-10 h-10 rounded-full transition-all duration-300 relative" 
                    :class="searchOpen ? 'text-blue-600 scale-110' : 'text-gray-500 hover:text-gray-800'">
                <div x-show="searchOpen" class="absolute inset-0 bg-white/40 blur-lg rounded-full"></div>
                <svg class="w-6 h-6 relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
            </button>

            <button @click="currentView = 'favorites'; window.scrollTo({top:0})" 
                    class="flex items-center justify-center w-10 h-10 rounded-full transition-all duration-300 relative" 
                    :class="currentView === 'favorites' && !searchOpen ? 'text-blue-600 scale-110' : 'text-gray-500 hover:text-gray-800'">
                <div x-show="currentView === 'favorites' && !searchOpen" class="absolute inset-0 bg-white/40 blur-lg rounded-full"></div>
                <svg x-show="currentView !== 'favorites'" class="w-6 h-6 relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>
                <svg x-show="currentView === 'favorites' && !searchOpen" class="w-6 h-6 relative z-10" fill="currentColor" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
            </button>

            <a href="https://wa.me/526333331107" class="flex items-center justify-center w-10 h-10 rounded-full text-green-600 hover:bg-white/20 transition-all duration-300 relative">
                <span class="absolute top-2 right-2 w-2 h-2 bg-red-500 rounded-full border border-white"></span>
                <svg class="w-7 h-7 filter drop-shadow-sm" fill="currentColor" viewBox="0 0 24 24"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.297-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.463 1.065 2.875 1.213 3.074.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.626.712.226 1.36.194 1.872.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z"/></svg>
            </a>

            <button @click="currentView = 'profile'; window.scrollTo({top:0})" 
                    class="flex items-center justify-center w-10 h-10 rounded-full transition-all duration-300 relative" 
                    :class="currentView === 'profile' && !searchOpen ? 'text-blue-600 scale-110' : 'text-gray-500 hover:text-gray-800'">
                <div x-show="currentView === 'profile' && !searchOpen" class="absolute inset-0 bg-white/40 blur-lg rounded-full"></div>
                <svg class="w-6 h-6 relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
            </button>

        </div>
    </nav>

    <div x-show="selectedCar" style="display: none;" class="fixed inset-0 z-[60] flex justify-end"
         x-transition:enter="transition duration-500 ease-out-expo" x-transition:enter-start="opacity-0 translate-x-full" x-transition:enter-end="opacity-100 translate-x-0"
         x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100 translate-x-0" x-transition:leave-end="opacity-0 translate-x-full">
        <div class="w-full h-full bg-white flex flex-col relative">
            <button @click="closeCar()" class="absolute top-4 left-4 z-20 liquid-glass-frost text-gray-900 p-2.5 rounded-full active:scale-90 transition-transform shadow-lg">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
            </button>
            <div class="absolute top-4 right-4 z-20 flex gap-3">
                <template x-if="selectedCar">
                    <button @click.stop="toggleFavorite(selectedCar.id)" class="liquid-glass-frost p-2.5 rounded-full active:scale-90 transition-transform shadow-lg" :class="favorites.includes(selectedCar.id) ? 'bg-white text-red-500' : 'text-gray-900'">
                        <svg x-show="favorites.includes(selectedCar.id)" class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                        <svg x-show="!favorites.includes(selectedCar.id)" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>
                    </button>
                </template>
                <button class="liquid-glass-frost p-2.5 rounded-full active:scale-90 transition-transform shadow-lg text-gray-900"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"></path></svg></button>
            </div>
            <div class="h-1/2 bg-gray-200 relative">
                <template x-if="selectedCar"><img :src="selectedCar.image" class="w-full h-full object-cover"></template>
                <div class="absolute bottom-0 left-0 w-full bg-gradient-to-t from-black/80 to-transparent p-6 pt-20">
                    <template x-if="selectedCar">
                        <div>
                            <div class="flex items-center gap-2 mb-1">
                                <span x-show="selectedCar.promoted" class="bg-yellow-400 text-yellow-900 text-[10px] font-bold px-2 py-0.5 rounded">PATROCINADO</span>
                                <span x-show="selectedCar.verified" class="bg-blue-600 text-white text-[10px] font-bold px-2 py-0.5 rounded flex items-center gap-1"><svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg> Verificado</span>
                            </div>
                            <h2 class="text-3xl font-extrabold text-white" x-text="formatMoney(selectedCar.price)"></h2>
                        </div>
                    </template>
                </div>
            </div>
            <div class="flex-1 p-6 overflow-y-auto bg-white -mt-4 rounded-t-3xl relative z-10 shadow-[0_-10px_40px_rgba(0,0,0,0.1)]">
                <template x-if="selectedCar">
                    <div>
                        <h1 class="text-2xl font-bold text-gray-900 leading-tight mb-4" x-text="selectedCar.model"></h1>
                        <div class="grid grid-cols-2 gap-4 mb-6">
                            <div class="bg-gray-50 p-3 rounded-xl border border-gray-100"><p class="text-xs text-gray-400 font-bold uppercase">A√±o</p><p class="font-bold text-gray-800" x-text="selectedCar.year"></p></div>
                            <div class="bg-gray-50 p-3 rounded-xl border border-gray-100"><p class="text-xs text-gray-400 font-bold uppercase">Transmisi√≥n</p><p class="font-bold text-gray-800" x-text="selectedCar.trans"></p></div>
                            <div class="bg-gray-50 p-3 rounded-xl border border-gray-100"><p class="text-xs text-gray-400 font-bold uppercase">Legal</p><p class="font-bold text-gray-800" x-text="selectedCar.legal"></p></div>
                            <div class="bg-gray-50 p-3 rounded-xl border border-gray-100"><p class="text-xs text-gray-400 font-bold uppercase">Kilometraje</p><p class="font-bold text-gray-800" x-text="selectedCar.km + ' km'"></p></div>
                        </div>
                        <div class="mb-24"><h3 class="font-bold text-gray-900 mb-2">Descripci√≥n</h3><p class="text-gray-500 leading-relaxed text-sm" x-text="selectedCar.description || 'Sin descripci√≥n detallada.'"></p></div>
                    </div>
                </template>
            </div>
            <div class="absolute bottom-0 w-full liquid-glass backdrop-blur-xl border-t border-white/40 p-4 pb-8 flex items-center gap-4 z-50">
                <a href="tel:+526333331107" class="flex-none w-14 h-14 rounded-full liquid-button flex items-center justify-center text-blue-600 active:scale-95 transition-transform shadow-lg"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path></svg></a>
                <template x-if="selectedCar">
                    <a :href="'https://wa.me/526333331107?text=Me interesa el ' + selectedCar.model" class="flex-1 bg-gradient-to-r from-blue-600/90 to-blue-700/90 backdrop-blur-md text-white font-bold h-14 rounded-full flex items-center justify-center gap-2 shadow-xl border border-white/30 active:scale-95 transition-transform">
                        <span>Me Interesa</span>
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
                    </a>
                </template>
            </div>
        </div>
    </div>

    <div x-show="searchOpen" style="display: none;" class="fixed inset-0 z-[80] flex items-end justify-center bg-black/40 backdrop-blur-sm"
         x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100"
         x-transition:leave="transition ease-in duration-150" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
        
        <div class="w-full rounded-t-[40px] p-6 pb-24 shadow-[0_-10px_60px_rgba(0,0,0,0.2)] liquid-glass border-t border-white/30" @click.outside="closeSearch()"
             x-transition:enter="transition ease-out duration-300" x-transition:enter-start="translate-y-full" x-transition:enter-end="translate-y-0"
             x-transition:leave="transition ease-in duration-200" x-transition:leave-start="translate-y-0" x-transition:leave-end="translate-y-full">
            
            <div class="w-16 h-1 bg-white/30 rounded-full mx-auto mb-8"></div>
            
            <div class="relative group mb-8">
                <span class="absolute left-4 top-4 text-gray-500"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></span>
                <input x-ref="searchInput" id="mobileSearchInput" type="text" x-model="search" placeholder="Busca por marca..." 
                       class="w-full bg-white/20 text-gray-900 rounded-3xl py-4 pl-12 pr-4 text-lg font-medium border border-white/10 focus:bg-white/40 focus:ring-0 focus:outline-none transition-all placeholder-gray-600/60 backdrop-blur-md shadow-inner" 
                       @keyup.enter="closeSearch()">
            </div>

            <div class="grid grid-cols-2 gap-3">
                <button @click="search = 'Trokas'; closeSearch()" class="p-4 bg-white/10 rounded-2xl border border-white/20 flex items-center gap-3 hover:bg-white/20 active:scale-95 transition-all shadow-sm backdrop-blur-md">
                    <span class="text-2xl">üõª</span><span class="font-bold text-gray-700">Trokas</span>
                </button>
                <button @click="search = 'Nacional'; closeSearch()" class="p-4 bg-white/10 rounded-2xl border border-white/20 flex items-center gap-3 hover:bg-white/20 active:scale-95 transition-all shadow-sm backdrop-blur-md">
                    <span class="text-2xl">üá≤üáΩ</span><span class="font-bold text-gray-700">Nacional</span>
                </button>
                <button @click="search = 'Economico'; closeSearch()" class="p-4 bg-white/10 rounded-2xl border border-white/20 flex items-center gap-3 hover:bg-white/20 active:scale-95 transition-all shadow-sm backdrop-blur-md">
                    <span class="text-2xl">‚õΩ</span><span class="font-bold text-gray-700">Econ√≥mico</span>
                </button>
                <button @click="search = '4x4'; closeSearch()" class="p-4 bg-white/10 rounded-2xl border border-white/20 flex items-center gap-3 hover:bg-white/20 active:scale-95 transition-all shadow-sm backdrop-blur-md">
                    <span class="text-2xl">‚õ∞Ô∏è</span><span class="font-bold text-gray-700">4x4</span>
                </button>
            </div>
        </div>
    </div>

    <div x-show="filterOpen" style="display: none;" class="fixed inset-0 z-[80] bg-black/30 backdrop-blur-sm flex flex-col justify-end"
         x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100"
         x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
         
        <div class="liquid-glass w-full h-[85vh] rounded-t-[40px] flex flex-col overflow-hidden shadow-2xl border-t border-white/40"
             x-transition:enter="transition ease-out duration-300" x-transition:enter-start="translate-y-full" x-transition:enter-end="translate-y-0"
             x-transition:leave="transition ease-in duration-200" x-transition:leave-start="translate-y-0" x-transition:leave-end="translate-y-full">
             
            <div class="flex items-center justify-between px-6 py-5 border-b border-white/20 bg-white/10 backdrop-blur-md">
                <h2 class="text-2xl font-black text-gray-900 tracking-tight drop-shadow-sm">Filtros</h2>
                <button @click="closeFilter()" class="p-2 bg-white/20 rounded-full hover:bg-white/40 text-gray-600 transition-colors backdrop-blur-sm">‚úï</button>
            </div>
            
            <div class="flex-1 flex overflow-hidden">
                <div class="w-1/3 bg-white/5 backdrop-blur-md border-r border-white/10 overflow-y-auto">
                    <template x-for="tab in [{id:'price', name:'Precio'}, {id:'brand', name:'Marca'}, {id:'year', name:'A√±o'}]">
                        <button @click="activeFilterTab = tab.id" class="w-full text-left px-4 py-6 text-sm font-bold border-l-4 transition-all" :class="activeFilterTab === tab.id ? 'bg-white/20 border-blue-600 text-blue-700 shadow-inner' : 'border-transparent text-gray-500 hover:text-gray-800'"><span x-text="tab.name"></span></button>
                    </template>
                </div>
                <div class="w-2/3 p-6 overflow-y-auto bg-white/10 backdrop-blur-sm">
                    <div x-show="activeFilterTab === 'price'">
                        <h3 class="text-lg font-bold text-gray-900 mb-6 drop-shadow-sm">Rango de Precio</h3>
                        <div class="space-y-4">
                            <div class="bg-white/40 rounded-2xl px-4 py-3 shadow-inner border border-white/20 focus-within:ring-2 focus-within:ring-blue-500/50 transition-all backdrop-blur-md">
                                <label class="text-[10px] text-gray-500 block font-bold uppercase tracking-wide">Desde</label>
                                <div class="flex items-center"><span class="text-gray-500 mr-1">$</span><input type="number" x-model="minPrice" class="w-full outline-none font-bold text-gray-900 bg-transparent placeholder-gray-400" placeholder="0"></div>
                            </div>
                            <div class="bg-white/40 rounded-2xl px-4 py-3 shadow-inner border border-white/20 focus-within:ring-2 focus-within:ring-blue-500/50 transition-all backdrop-blur-md">
                                <label class="text-[10px] text-gray-500 block font-bold uppercase tracking-wide">Hasta</label>
                                <div class="flex items-center"><span class="text-gray-500 mr-1">$</span><input type="number" x-model="maxPrice" class="w-full outline-none font-bold text-gray-900 bg-transparent placeholder-gray-400" placeholder="Max"></div>
                            </div>
                        </div>
                    </div>
                    <div x-show="activeFilterTab === 'brand'">
                        <h3 class="text-lg font-bold text-gray-900 mb-4 drop-shadow-sm">Marcas</h3>
                        <div class="space-y-3">
                             <template x-for="brand in ['Ford', 'Toyota', 'Nissan', 'Honda', 'Chevrolet', 'Dodge']">
                                <label class="flex items-center gap-3 p-3 bg-white/40 rounded-xl cursor-pointer hover:bg-white/60 border border-white/30 shadow-sm backdrop-blur-sm transition-all">
                                    <input type="checkbox" :value="brand" x-model="selectedBrands" class="w-5 h-5 text-blue-600 rounded focus:ring-blue-500 bg-white/50 border-gray-300">
                                    <span class="font-medium text-gray-800" x-text="brand"></span>
                                </label>
                             </template>
                        </div>
                    </div>
                     <div x-show="activeFilterTab === 'year'">
                        <h3 class="text-lg font-bold text-gray-900 mb-4">A√±o</h3>
                        <p class="text-gray-500 text-sm">Pr√≥ximamente...</p>
                    </div>
                </div>
            </div>
            
            <div class="p-6 border-t border-white/20 flex gap-4 pb-10 bg-white/20 backdrop-blur-xl">
                <button @click="clearFilters()" class="flex-1 py-4 text-gray-600 font-bold hover:bg-white/30 rounded-2xl transition-colors border border-transparent hover:border-white/20">Limpiar</button>
                <button @click="applyFilters()" class="flex-[2] py-4 bg-black/80 backdrop-blur-md text-white font-bold rounded-2xl shadow-lg border border-white/20 active:scale-95 transition-all">Ver Resultados</button>
            </div>
        </div>
    </div>

    <div x-show="sortOpen" style="display: none;" class="fixed inset-0 z-[70] flex items-end justify-center bg-black/40 backdrop-blur-sm"
         x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100"
         x-transition:leave="transition ease-in duration-150" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
        <div class="liquid-glass w-full rounded-t-[40px] max-h-[85vh] overflow-y-auto shadow-2xl border-t border-white/30" @click.outside="closeSort()"
             x-transition:enter="transition ease-out duration-300" x-transition:enter-start="translate-y-full" x-transition:enter-end="translate-y-0"
             x-transition:leave="transition ease-in duration-200" x-transition:leave-start="translate-y-0" x-transition:leave-end="translate-y-full">
            <div class="sticky top-0 bg-white/10 backdrop-blur-xl border-b border-white/20 px-6 py-6 flex items-center justify-between z-10">
                <h2 class="text-xl font-black text-gray-800 tracking-tight">Ordenar por</h2>
                <button @click="closeSort()" class="p-2 bg-white/20 rounded-full text-gray-600 hover:bg-white/40">‚úï</button>
            </div>
            <div class="p-6 pb-12 space-y-2 bg-white/40">
                <template x-for="option in [{val: 'relevance', label: 'M√°s relevantes'}, {val: 'price_asc', label: 'Menor precio'}, {val: 'price_desc', label: 'Mayor precio'}, {val: 'km_asc', label: 'Menos kilometraje'}, {val: 'year_desc', label: 'M√°s nuevo (A√±o)'}]">
                    <div @click="applySort(option.val)" class="flex items-center justify-between p-4 rounded-2xl cursor-pointer transition-all" :class="sortBy === option.val ? 'bg-white shadow-sm border border-white/50' : 'hover:bg-white/20 border border-transparent'">
                        <span class="font-medium text-gray-700" :class="sortBy === option.val ? 'text-blue-700 font-bold' : ''" x-text="option.label"></span>
                        <div class="w-5 h-5 rounded-full border-2 flex items-center justify-center" :class="sortBy === option.val ? 'border-blue-600' : 'border-gray-400/50'">
                            <div x-show="sortBy === option.val" class="w-2.5 h-2.5 bg-blue-600 rounded-full"></div>
                        </div>
                    </div>
                </template>
            </div>
        </div>
    </div>

    <div x-show="sellerModalOpen" style="display: none;" class="fixed inset-0 z-[90] flex items-center justify-center bg-black/60 backdrop-blur-md p-4"
         x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100"
         x-transition:leave="transition ease-in duration-150" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
        <div class="liquid-glass w-full max-w-sm rounded-[32px] shadow-2xl overflow-hidden max-h-[90vh] overflow-y-auto"
             x-transition:enter="transition ease-out duration-300" x-transition:enter-start="scale-90 opacity-0" x-transition:enter-end="scale-100 opacity-100"
             x-transition:leave="transition ease-in duration-200" x-transition:leave-start="scale-100 opacity-100" x-transition:leave-end="scale-90 opacity-0">
            
            <div class="bg-gradient-to-br from-purple-600/90 to-blue-600/90 p-8 text-white text-center backdrop-blur-md">
                <div class="w-16 h-16 bg-white/20 rounded-full mx-auto mb-4 flex items-center justify-center backdrop-blur shadow-inner border border-white/30">
                    <span class="text-3xl">üöó</span>
                </div>
                <h3 class="text-2xl font-extrabold mb-1">Vendedor</h3>
                <p class="text-white/70 text-sm font-medium">√önete a la red NexCar</p>
            </div>

            <div class="p-6 bg-white/60 backdrop-blur-xl">
                <template x-if="isPendingSeller">
                    <div class="text-center py-4">
                        <div class="w-16 h-16 bg-yellow-100 rounded-full mx-auto mb-4 flex items-center justify-center">
                            <svg class="w-8 h-8 text-yellow-600 animate-spin" fill="none" viewBox="0 0 24 24">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path>
                            </svg>
                        </div>
                        <h4 class="font-bold text-gray-900 mb-2">Solicitud en Revisi√≥n</h4>
                        <p class="text-gray-500 text-sm mb-4">Estamos revisando tu informaci√≥n. Te contactaremos pronto.</p>
                        <button @click="sellerModalOpen = false" class="w-full py-3 bg-gray-100 text-gray-700 font-bold rounded-xl">
                            Entendido
                        </button>
                    </div>
                </template>

                <template x-if="!isPendingSeller">
                    <div class="space-y-4">
                        <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Tipo de Vendedor</label>
                            <div class="grid grid-cols-2 gap-2">
                                <button type="button" 
                                        @click="sellerForm.type = 'independent'"
                                        class="p-4 rounded-2xl border transition-all shadow-sm"
                                        :class="sellerForm.type === 'independent' ? 'border-purple-500 bg-purple-50 text-purple-700' : 'border-white/50 bg-white/50 text-gray-600 hover:bg-white'">
                                    <span class="text-2xl block mb-1">üë§</span>
                                    <span class="text-xs font-bold">Independiente</span>
                                </button>
                                <button type="button"
                                        @click="sellerForm.type = 'dealer'"
                                        class="p-4 rounded-2xl border transition-all shadow-sm"
                                        :class="sellerForm.type === 'dealer' ? 'border-purple-500 bg-purple-50 text-purple-700' : 'border-white/50 bg-white/50 text-gray-600 hover:bg-white'">
                                    <span class="text-2xl block mb-1">üè¢</span>
                                    <span class="text-xs font-bold">Agencia/Lote</span>
                                </button>
                            </div>
                        </div>

                        <div x-show="sellerForm.type === 'dealer'" x-transition>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Nombre del Negocio</label>
                            <input type="text" x-model="sellerForm.businessName" placeholder="Ej. Autos L√≥pez" 
                                   class="w-full p-4 bg-white/70 rounded-2xl border-transparent focus:bg-white focus:ring-2 focus:ring-purple-500 outline-none transition-all shadow-sm">
                        </div>

                        <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-2">¬øCu√°ntos autos vendes al mes?</label>
                            <div class="grid grid-cols-3 gap-2">
                                <button type="button" @click="sellerForm.volume = '1-3'"
                                        class="p-3 rounded-xl border text-center text-sm font-bold transition-all"
                                        :class="sellerForm.volume === '1-3' ? 'border-purple-500 bg-purple-50 text-purple-700' : 'border-white/50 bg-white/50 text-gray-500'">
                                    1-3
                                </button>
                                <button type="button" @click="sellerForm.volume = '4-10'"
                                        class="p-3 rounded-xl border text-center text-sm font-bold transition-all"
                                        :class="sellerForm.volume === '4-10' ? 'border-purple-500 bg-purple-50 text-purple-700' : 'border-white/50 bg-white/50 text-gray-500'">
                                    4-10
                                </button>
                                <button type="button" @click="sellerForm.volume = '10+'"
                                        class="p-3 rounded-xl border text-center text-sm font-bold transition-all"
                                        :class="sellerForm.volume === '10+' ? 'border-purple-500 bg-purple-50 text-purple-700' : 'border-white/50 bg-white/50 text-gray-500'">
                                    10+
                                </button>
                            </div>
                        </div>

                        <div x-show="needsPhoneForSeller" x-transition>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-1">WhatsApp / Tel√©fono</label>
                            <div class="flex shadow-sm rounded-2xl">
                                <span class="inline-flex items-center px-4 bg-gray-100 text-gray-600 rounded-l-2xl border-r border-gray-200 text-sm font-bold">
                                    üá≤üáΩ +52
                                </span>
                                <input type="tel" x-model="sellerForm.phone" placeholder="633 123 4567" 
                                       class="flex-1 p-4 bg-white/70 rounded-r-2xl border-transparent focus:bg-white focus:ring-2 focus:ring-purple-500 outline-none transition-all">
                            </div>
                        </div>

                        <div x-show="!needsPhoneForSeller" class="bg-green-50 border border-green-200 rounded-xl p-3 flex items-center gap-3">
                            <span class="text-green-600">‚úì</span>
                            <div class="flex-1">
                                <p class="text-xs text-green-700 font-medium">WhatsApp registrado</p>
                                <p class="text-sm text-green-800 font-bold" x-text="userProfile?.phone"></p>
                            </div>
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Ciudad</label>
                            <input type="text" x-model="sellerForm.city" placeholder="Ej. Hermosillo, Sonora" 
                                   class="w-full p-4 bg-white/70 rounded-2xl border-transparent focus:bg-white focus:ring-2 focus:ring-purple-500 outline-none transition-all shadow-sm">
                        </div>
                        <button @click="submitSellerRequest()" 
                                :disabled="!canSubmitSellerForm"
                                class="w-full py-4 font-bold rounded-xl transition-all mt-4"
                                :class="canSubmitSellerForm ? 'bg-purple-600 text-white shadow-lg shadow-purple-200 active:scale-95' : 'bg-gray-200 text-gray-400 cursor-not-allowed'">
                            <span x-show="!sellerFormLoading">Enviar Solicitud</span>
                            <span x-show="sellerFormLoading" class="flex items-center justify-center gap-2">
                                <svg class="w-5 h-5 animate-spin" fill="none" viewBox="0 0 24 24">
                                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path>
                                </svg>
                                Enviando...
                            </span>
                        </button>

                        <button @click="sellerModalOpen = false; resetSellerForm()" class="w-full py-2 text-gray-400 font-medium text-sm hover:text-gray-600">
                            Cancelar
                        </button>
                    </div>
                </template>
            </div>
        </div>
    </div>

</body>
</html>